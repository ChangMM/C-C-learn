
# C和C++部分易错知识点总结

##基础

###变量类型
无符号类型(unsigned int)与有符号类型(int)运算的时候，编译器会先把有符号类型强制转化为无符号类型的数再运算。
```
unsigned int a = 10;
int b = 20;
a - b = -10; //error
```
### typedef 和 \#define 的区别
- 执行的时间点不同
  - 关键字 typedef 在编译阶段有效，由于是在编译阶段，因此 typedef 有类型检查的功能。
  - \#define 则是宏定义，发生在预处理阶段，也就是编译之前，它只进行简单而机械的字符串替换，而不进行任何检查。

- 功能有差异
  - typedef 用来定义类型的别名，定义与平台无关的数据类型，与 struct 的结合使用等。
  - \#define 不只是可以为类型取别名，还可以定义常量、变量、编译开关等。

- 对指针的操作不同
  ```
  typedef int * pint;
  #define PINT int *;

  int i1 = 1, i2 = 2;
  const pint p1 = &i1;  //p不可更改，p指向的内容可以更改，相当于 int * const p;
  const PINT p2 = &i2;  //p可以更改，p指向的内容不能更改，相当于 const int *p；或 int const *p；
  ```

###常量指针与指针常量的区别
- 常量指针: `int const * p | const int * p`
  * 不可以通过常量指针修改其所指向内容的值，但是可以修改常量指针的值。
  * 不能把常量指针赋值给非常量指针，反之可以。

- 指针常量: `int* const p`
  * 不可以修改常量指针的值，但是可以修改常量指针指向内容的值。


##函数
###内部函数与外部函数
根据函数能否被其他源文件调用，将函数区分为内部函数和外部函数。
- 内部函数  
  - 如果一个函数只能被本文件中其他函数所调用，它称为内部函数。在定义内部函数时，在函数名和函数类型的前面加 static，即 `static 类型名 函数名 （形参表）`

  - 内部函数又称静态函数。使用内部函数，可以使函数的作用域只局限于所在文件。即使在不同的文件中有同名的内部函数，也互不干扰。提高了程序的可靠性。

- 外部函数
  - 如果在定义函数时，在函数的首部的最左端加关键字 extern，则此函数是外部函数，可供其它文件调用。如函数首部可以为 `extern int max (int a,int b)`

  - C 语言规定，如果在定义函数时省略 extern，则默认为外部函数。

  - 在需要调用此函数的其他文件中，需要对此函数作声明（不要忘记，即使在本文件中调用一个函数，也要用函数原型来声明）。在对此函数作声明时，要加关键字 extern，表示该函数是在其他文件中定义的外部函数。

###函数指针
函数指针是指向函数的指针变量。 通常我们说的指针变量是指向一个整型、字符型或数组等变量，而函数指针是指向函数。

函数指针可以像一般函数一样，用于调用函数、传递参数以及作为参数来当做回调函数使用。

函数指针变量的声明：
```
typedef int (*fun_ptr)(int,int); // 声明一个指向同样参数、返回值的函数指针类型
```

###函数指针的应用 qsort 函数
qsort 函数是 ANSI C 标准中提供的，其声明在 stdlib.h 文件中，是根据二分发写的，其时间复杂度为 n*log(n) ,其结构为：
```
void qsort(void *base,size_t nelem,size_t width,int (*Comp)(const void *,const void *));
```
其中：
- \*base 为要排序的数组

- nelem 为要排序的数组的长度

- width 为数组元素的大小（以字节为单位）

- `（* Comp）(const void *p1,const void *p2)` 为判断大小函数的指针，这个函数需要自己定义，如果p1>p2,函数返回-1；a<b,函数返回1；a==b函数返回0
